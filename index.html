<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Screen Video with Overlay</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.min.css" rel="stylesheet">
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        #video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        #my-video {
            width: 100vw;
            height: 100vh;
            object-fit: cover;
        }
        #overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 5vw; /* Responsive font size */
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
    </style>
</head>
<!-- https://br5093.streamingdevideo.com.br/abc/abc/manifest.mpd -->
<body>
    <div id="video-container">
        <video id="my-video" class="video-js vjs-default-skin vjs-big-play-centered" controls autoplay playsinline>
        </video>
    </div>

    <div id="overlay">
        <div id="server-time"></div>
        <div>opa, legal Anderson, funcionou !</div>
    </div>

    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script>
        function updateServerTime() {
            const timeElement = document.getElementById("server-time");
            const now = new Date();
            timeElement.textContent = now.toISOString().substr(11, 12);
        }

        async function initializePlayer() {
            const videoElement = document.getElementById("my-video");

            try {
                const configuration = {
                    iceServers: [{
                        urls: 'stun:stun.l.google.com:19302'
                    }]
                };

                const peerConnection = new RTCPeerConnection(configuration);

                // Create and send WHEP offer
                const whepUrl = 'https://sirius.navve.studio/rtc/v1/whep/?app=live&stream=alphacine';

                // Create offer
                const offer = await peerConnection.createOffer({
                    offerToReceiveVideo: true,
                    offerToReceiveAudio: true
                });
                await peerConnection.setLocalDescription(offer);

                // Send offer to WHEP endpoint
                const response = await fetch(whepUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/sdp'
                    },
                    body: offer.sdp
                });

                if (!response.ok) {
                    throw new Error('WHEP request failed');
                }

                // Get and set remote description
                const answerSdp = await response.text();
                await peerConnection.setRemoteDescription({
                    type: 'answer',
                    sdp: answerSdp
                });

                peerConnection.ontrack = function(event) {
                    if (videoElement.srcObject !== event.streams[0]) {
                        videoElement.srcObject = event.streams[0];
                    }
                };

                // Start updating server time
                setInterval(updateServerTime, 100); // Update every 100ms
            } catch (error) {
                console.error('Error initializing WebRTC:', error);
            }
        }

        document.addEventListener("DOMContentLoaded", initializePlayer);
    </script>
</body>
</html>

